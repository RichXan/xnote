2024daily work

11.11
- 测试创建订单流程
- 当前成交份额小于订单成交份额会产生panic
- order_notify
- broker创建流水失败后不会出金回退

11.12
- 测试验证买单流程，数据正确性
- 新增创建订单v3接口

11.13
- 修改创建订单v3接口传入参数
- 获取用户持仓列表、客户持仓列表、交易记录、订单记录

11.14
- 获取收益记录
- 收益计算器
- 预付利息计算

11.15
- 开发broker收益计算器和预付利息计算接口。
- 完善broker对接交易所下单，订单撮合，订单撤销流程。
- 测试验证数据更新准确性，解决数据缺失，数据更新错误问题。

--------------------------------

11.18
- 在broker路由中添加获取账号信息中间件。
- 测试验证中间件信息传递到业务层
- 调整broker对接前端请求参数

11.19
- 对接app端接入broker api接口
- 测试broker proxy接入broker svc
- 整理好了app端请求参数的调整
- 产品交易详情的接口开发

11.20
- ipo份额分配接口
- broker实现获取活利得理财周期，利率周期记录、债券易理财周期接口
- 对接账户系统冻结、划扣金额验证

11.21
- 修复产品交易详情接口无数据问题
- 和前端app联调测试，修复接口bug

11.22
- 与前端app联调买卖交易流程，修复接口bug与提供数据测试

--------------------------------


11.25
- broker后台对接app
- 当日基金盈亏任务计算
- 用户每日基金产品盈亏的计算

11.26
- cfund基金当日、指定日、区间日期盈亏计算任务开发
- cfund用户基金当日、指定日、区间日期市价以及前一日市价任务计算开发

11.27
- 修改cfund-jobs迁移为xxl-jobs
- 将cfund-jobs部署到测试服务器并测试验证jobs执行流程

11.28
- 与测试联调app，修改交易所交易bug
- 梳理calastone对接接口文档，对接calastone接口
- 开发订单提交到calastonejobs

11.29
- 删除cfund-jobs-svc里的go-common job
- cfund-jobs-svc盈亏两个job合并
- 按照holding_history来执行job，包含可以指定用户
- 分层service
- 缓存查询出的数据（map）

- calastone定时提交order job
- 定时查询order并更新order状态job

--------------------------------

12.3
- 配合测试，修复由于数据库account信息被删除导致的bug
- 对接calastone实现订单申购，赎回请求接口

12.4
- 修复broker端买卖单逻辑修改为面值下单
- 对接calastone实现订单信息获取，订单查询接口，设计calastone_order订单信息数据库表。

12.5
- 与calastone沟通验证申购，赎回时订单状态的变化流程
- 开发将交易所中订单提交到calastone的定时任务
- 修改broker下买卖单为面值是整数，份额可以精确到0.01
- cfund-job的盈亏计算中dailyholding添加dailygainloss，buyAmt，sellAmt，cashDividend数据

12.6
- 修复部署cfund-job计算bug，添加默认前五日一并计算任务
- 开发calastone提交申购赎回订单到calastone任务job

--------------------------------

12.9
- 修复部署cfund-job计算bug，添加默认前五日一并计算任务
- 开发calastone提交申购赎回订单到calastone任务job

12.10
- 开发calastone订单状态查询更新任务job
- 测试job业务流程状态变更验证
- ifund-job部署测试服务器

12.11
- 开发立桥每日盈亏计算任务job
- 部署到airflow并测试任务执行状态

12.12
- 开发归并提交订单job
- 获取立桥债券订单信息并提交到tob
- 部署到airflow测试环境并验证任务执行状态

12.13
- 开发ifund-tob-svc的获取指定债券订单接口
- 开发cbond-trade-svc的获取债券订单列表接口
- 通过获取债券订单接口更新bond_order订单

--------------------------------

12.16
- 完善立桥cfund-jobs-go状态信息任务
- calastone 卖单对接，交换订单对接。
- 立桥获取债券接口功能完善。

12.17
- broker端开户接口对接账户系统
- broker-job测试环境部署及修复

12.18
- 改交易所获取产品详情接口
- 修复broker端的一些bug
- broker端获取产品交易详情的可售面值字段与交易所同步
- 开发broker端更新开户api

12.19
- 开发broker端更新开户api
- 修复broker端更新开户返回数据内容
- 开发ibond-jobs更新债券订单信息job

12.20
- 开发cbond-trade-svc获取用户债券订单接口
- 测试cbond-trade-svc下单申购、取消订单接口
- 与前端联调测试下买单、取消订单接口

--------------------------------

12.23
- 开发cbond-trade-svc获取订单详情接口并与前端对接
- 修改cbond-trade-svc调用proxy使用方法，增加otc债券类型

12.24
- 修复获取取消订单死锁bug
- 修改cbond-trade-svc获取用户债券订单接口
- 交易流程相关接口修改为请求头添加用户信息
- 修改并验证赎回订单流程

12.25
- 修复东证下单失败接口
- 修复向东证下单时失败的处理逻辑接口
- 开发cbond-jobs更新订单状态任务

12.26
- 新增获取ibond订单获取接口
- 调整下单接口接入access层
- 修改cbond下单时计息的方式
- 开发cbond-jobs更新订单状态任务

12.27
- 开发cbond-jobs更新申购、赎回、取消订单状态任务
- 开发获取ibond-trade-svc订单获取接口

12.30
- 开发ibond-job更新订单状态任务
- cbond-trade-svc新增下单申购校验
- 配合前端测试cbond下单验证

12.31
- 对接东证，开发ibond-job更新订单状态任务
- 部署cbond-job到测试服务器

--------------------------------

1.2
- 迁移获取债券订单、历史成交信息接口到立桥上
- 修复cbond-trade-svc，立桥api接口bug

1.6
- 设计上手方管理相关数据库表结构
- 开发上手方管理相关接口

1.8
- 开发上手方管理接口
- 开发上手方产品管理接口
- 开发上手方交易记录接口

1.9
- 和前端对接上手方相关接口
- 开发上手方每日债券持仓记录job

1.10
- 开发上手方每日持仓记录接口
- 开发上手方每日持仓记录导出接口

--------------------------------


综合管理平台的产品管理支持活利得/债券易上下架接口。ta-admin-go 支持subda活利得/债券易产品上下架
上架在type中支持活利得/债券易
下架时在whitelist中删除数据
/v1/fund/subda/product接口

综合管理平台的今日申赎统计接口。ifund-statistics-svc中数据看板支持全部、多个subDA、单选的交收监控数据。参考PC首页的今日申赎统计接口。

pc端基金公司销售统计接口。ifund-statistics-svc，基金公司销售统计中 支持指定日期期间的统计数据。t_company_product_sales_statistics表的数据为每日的记录

近一年累计费用，t_overview_data_company_daily

--------------------------------

1.13
- 整理pc端开发需求
- 熟悉ta相关代码
- 开发获取渠道上下架产品接口

1.14
- 修复jira上手方相关bug
- 综合管理后台，渠道商的活利得债券易已上架、下架产品获取，上架下架接口。上下架变更记录接口

1.15
- 开发综合管理平台的今日申赎统计接口。添加指定subda、日期筛选
- 测试综合管理平台转发路由到ta-admin-go服务

1.16
- 开发pc端需求
- 与前端联调债券易 活利得上下架接口

1.17
- 处理立桥相关bug

1.18
- 处理立桥相关bug
- 搭建立桥cfund-admin，python环境

--------------------------------

1.20
- 处理线上、subda产品管理相关bug
- 熟悉立桥cfund-admin，python代码，整理立桥开发需求
- 开发cfund-admin资产管理新增冻结余额接口

1.21
- 开发cfund-admin资产管理新增债券持仓市值接口
- 开发cfund-admin债券手工订单查询接口
- 开发cfund-admin债券应计利息计算接口

1.22
- 开发cfund-admin债券手工订单创建接口
- 持仓页面新增客户级别信息

--------------------------------

2.5
- 开发手工订单申购赎回输入字段接口
- 修复立桥基金搜索三次后一直loading bug

2.6
- 修复立桥无法根据产品代码模糊查询基金信息bug
- 修复立桥根据基金名称模糊查询基金列表返回无关其他基金bug
- 修复立桥债券

2.7
- 获取债券信息、债券详情接口，添加返回多语言债券名称功能
- 修复立桥基金个别基金代码搜索不到数据bug
- 修复立桥基金搜索显示无网络bug
- 修复获取债券交易记录无法查询bug

2.8
- 修复立桥获取债券资产详情中金额保留两位小数问题
- 修复个别债券无法获取bug
- 修复产品上架审计bug

--------------------------------

2.10
- 修复基金内容获取删除投资策略信息
- 添加搜索内容支持productId查询

2.11
- 修复获取admin持仓汇总bug

2.12
- 修复综合管理平台产品上架问题
- 修复获取债券订单列表bug
- 修复获取订单列表排序问题

2.13
- 修复创建买卖债券订单时cashQueantityFlow数据错误bug
- 修复获取债券列表过滤下架产品数据问题
- 修复用户冻结金额为负数问题

2.14
- 在后台客户订单交易时添加金额/份额一致校验

--------------------------------

2.17
- 后台新增撤销债券订单功能
- 修复债券申购日期展示问题
- 修复用户债券订单展示问题
- 修复购买债券信息bug

2.18
- 修复客户撤单bug
- 债券列表支持仅专业投资者搜索
- 查询债券信息中添加最新参考价格时间字段返回

2.20
- 修复立桥买单以及利息计算问题

--------------------------------

2.24
- 修复立桥买单以及利息计算问题
- 修复立桥价格取值为百分比的逻辑
- 立桥新增订单早于有效期成交的利息返还功能

2.25
- 修复立桥获取资产信息bug
- ifund后台接口说明书增加OTC债券ToB功能的说明文档

2.26
- 梳理pc端开发需求任务
- 开发综合管理后台的做市商客户订单新增交易方式

2.27
- ibond-trade-svc下订单时调用xfund/ifund-trade-svc的下订单接口，并接收ifund-trade-svc的订单成交结果的回调通知

2.28
- 上手方持仓记录中添加渠道编码，用于渠道商挂单做市
- 将上手方持仓记录迁移到tadb中
- 在有上手方持仓交易记录的时候同步渠道商账户持仓信息
- 渠道商的账户查询：根据tadb.t_account.acctType = 1 查出accountId，根据accountId在t_sub_account表中查出subAccountId。更新subAccountId的持仓信息